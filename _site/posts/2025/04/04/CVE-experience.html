<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>CVE journey | kappa</title>
<meta name="generator" content="Jekyll v3.9.5" />
<meta property="og:title" content="CVE journey" />
<meta name="author" content="kappa" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="My experience on how I got my first CVE" />
<meta property="og:description" content="My experience on how I got my first CVE" />
<link rel="canonical" href="http://localhost:4000/posts/2025/04/04/CVE-experience.html" />
<meta property="og:url" content="http://localhost:4000/posts/2025/04/04/CVE-experience.html" />
<meta property="og:site_name" content="kappa" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-04-04T00:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="CVE journey" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"kappa"},"dateModified":"2025-04-04T00:00:00+02:00","datePublished":"2025-04-04T00:00:00+02:00","description":"My experience on how I got my first CVE","headline":"CVE journey","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/2025/04/04/CVE-experience.html"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/img/logo.jpg"},"name":"kappa"},"url":"http://localhost:4000/posts/2025/04/04/CVE-experience.html"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=9e8df5592deb296a21b80be7e67427827c5828b1">
    <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->

  </head>
  <body>
    <div class="wrapper">
      <header>

        <h1><a href="http://localhost:4000/">kappa</a></h1>

        
          <img src="/assets/img/logo.jpg" alt="Logo" />
        

        <p>Cybersecurity enthusiast :)</p>


        
        <ul class="downloads">
          <li><a href="https://github.com/kap-pa/">kappa<strong>Github</strong></a></li>
          <li><a href="https://www.linkedin.com/in/arnau-sola-l%C3%B3pez-0582ab230/">Arnau Sola<strong>LinkedIn</strong></a></li>
        </ul>
        
               <nav>
  <ul>
    <li><a href="/">Home</a></li>
  <li><a href="/about.html">About</a></li>
    
  
</ul>
</nav>
      </header>
      <section>

      <small>4 April 2025</small>
<h1>CVE journey</h1>


<h1 id="information">Information</h1>

<p>Seafilehub 12.0.10</p>

<p>Second Order Stored XSS: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L - 6.3 Medium</p>

<p><strong>Official security issue record:</strong> https://plus.seafile.com/wiki/publish/seafile-wiki/txzO/</p>

<h1 id="tldr">TL;DR</h1>

<p>Well, Mitre may be quite slow sometimes, but I hope this turns into a CVE in the near future.</p>

<p>First things first—this blog is more about the experience of getting my first CVE rather than the exploitation itself, since it isn’t a big deal (just a second-order XSS, lol). But I’m quite excited that I finally managed to translate my thoughts of “I want to get a CVE” into a real vulnerability.</p>

<p>To be honest, I’ve been feeling stuck since 2023. It felt like all that knowledge was slowly but surely fading from my brain. I was reading writeups about web challenges, learning new things like Active Directory, preparing for unnecessary certifications… it all felt like I wasn’t acquiring real skills.</p>

<p>So, I decided enough was enough. No more work that felt useless. I knew there were plenty of projects developed by small teams with limited security experience, and I thought I could actually be useful by helping them secure their software while I acquire new skills.</p>

<h2 id="my-experience">My experience</h2>

<h3 id="why-seafile">Why Seafile?</h3>

<p>So here we are, looking for an application that is widely used and could have vulnerability flaws. A peer of mine just sent me a CVE in localsend that was <strong>INCREDIBLY</strong> easy to find, with high severity, in a <strong>HUGE</strong> application. So then I decided that an application that supports file uploads would be nice, because maybe and only maybe, we could get an RCE (we never did).</p>

<h3 id="looking-for-the-vuln">Looking for the vuln</h3>

<p>To be fair, the main reason no one audits these applications might be that <strong>DEPLOYING AND UNDERSTANDING THEM</strong> can take hours. I probably wasted six hours of my life reading documentation just to deploy the correct component and host the page locally.</p>

<p>Then, there I was—staring at a gazillion lines of code written in different languages. It felt overwhelming, nothing like opening a CTF challenge where you only need to inspect 5-6 files for something suspicious.</p>

<p>My approach to this “greybox” audit was to first understand the application’s functionalities from a user’s perspective rather than a pentester’s. Once I checked what I could do, now I had to look for each component in the code.</p>

<p>Of course, I tried reading the code, but for someone unfamiliar with real-world applications, I was painfully slow
Looking back, a better start would’ve been using source code analysis tools like Snyk. Instead, my solution was intercepting requests of a functionality which behaviour was strange.
For example I would spam <code class="language-plaintext highlighter-rouge">"&gt;&lt;h1&gt;test&lt;/h1&gt;</code> in every input, see if it gets reflected or interpreted, and look for the sink in VSCode.</p>

<h3 id="conclusions">Conclusions</h3>
<p>Honestly, there was no need to dive that deep into the source code. Just being stubborn and testing everything could’ve led anyone to this result. I also found some oddities in the code that I couldn’t exploit, and I’m sure there are more issues to fix. There’s a whole custom authorization process with internal headers that looks sketchy, plus some non-parameterized SQL queries.
tbf I was feeling like this:
<img src="/assets/img/commons/CVE-XXXX-XX-XX/miner.png" alt="Resumen del soporte" class="center-image" /></p>

<p>It felt rewarding because I’d never tackled a real application before, and I learnt a lot beyond just technical skills. Sure, I was familiar with deploying apps and hunting for vulns, but I also had to write a report, use CVSS, contact the Seafile team and report to Mitre. I even found myself more interested in mitigation strategies, now that I understood the app’s internals and potential vulnerability sinks.</p>

<h2 id="exploitation">Exploitation</h2>
<p>The exploitation does not require any administrative privileges, just a normal user account.
The first step is creating a new library
<img src="/assets/img/commons/CVE-XXXX-XX-XX/image.png" alt="Resumen del soporte" class="center-image" /></p>

<p>Once we create the library we have to share it with the target.
<img src="/assets/img/commons/CVE-XXXX-XX-XX/image2.png" alt="Resumen del soporte" class="center-image" /></p>

<p>Now we have to create multiple files with a XSS payload. 
<img src="/assets/img/commons/CVE-XXXX-XX-XX/image3.png" alt="Resumen del soporte" class="center-image" />
<img src="/assets/img/commons/CVE-XXXX-XX-XX/image4.png" alt="Resumen del soporte" class="center-image" /></p>

<p>This will result in the creation of a new activity in the “Activity” page of the target, even administrators. 
<img src="/assets/img/commons/CVE-XXXX-XX-XX/image5.png" alt="Resumen del soporte" class="center-image" /></p>

<p>Source details:
<img src="/assets/img/commons/CVE-XXXX-XX-XX/image6.png" alt="Resumen del soporte" class="center-image" /></p>




      </section>
      <footer>
        
        <p>This project is maintained by <a href="https://github.com/kap-pa">kappa</a></p>
        
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="/assets/js/scale.fix.js"></script>
  </body>
</html>
